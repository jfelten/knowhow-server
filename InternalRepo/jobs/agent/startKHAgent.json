{
  "id": "starts KH Agent",
  "working_dir": "/tmp/KHAgent",
  "options": {
    "timeoutms": 360000
  },
  "files": [],
  "shell": {
    "command": "ssh",
    "args": [
      "-o",
      "StrictHostKeyChecking=no",
      "${USER}@${HOST}"
    ],
    "onConnect": {
      "timeoutms": 5000,
      "responses": {
        "login": "${USER}",
        "password": "${PASSWORD}"
      },
      "waitForPrompt": "[#]",
      "errorConditions": [
        "timed out",
        "denied"
      ]
    },
    "onExit": {
      "command": "exit\r\n"
    }
  },
  "script": {
    "env": {
      "USER": "root",
      "PASSWORD": "z3nz1c.c0m",
      "HOST": "master101.zenzic.com"
    },
    "commands": [
      {
        "command": "mkdir -p ${working_dir}"
      },
      {
        "command": "cd ${working_dir}"
      },
      {
        "command": "type startKHAgent >/dev/null 2>&1 || echo \"KHAgent is not installed\"; GLOBAL_INSTALL=\"false\""
      },
      {
        "command": "if [ -d \"knowhow-agent\" ]; then LOCAL_INSTALL=\"true\"; fi"
      },
      {
        "command": "if [ -n \"${GLOBAL_INSTALL}\" ]; then nohup startKHAgent  > /dev/null 2>&1& elif [ -n \"${LOCAL_INSTALL}\" ]; then node knowhow-agent/agent.js > /dev/null 2 >&1& fi"
      }
    ]
  }
}